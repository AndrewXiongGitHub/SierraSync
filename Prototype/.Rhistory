# Total Losses
totalLosses = sum(profit_loss_c < 0, na.rm = TRUE),
# Win Rate (Count of wins / Total considered trades)
winRate = if_else(totalTrades > 0,
sum(profit_loss_c > 5, na.rm = TRUE) / totalTrades,
0),
# Loss Rate (Count of losses / Total considered trades)
loseRate = if_else(totalTrades > 0,
sum(profit_loss_c < 0, na.rm = TRUE) / totalTrades,
0)
)
)
}
setup_env()
setup_env = function()
{
library(readxl)
library(tidyverse)
library(readr)
library(janitor)
library(hms)
TradesList <- read_delim("C:/SierraChart/SavedTradeActivity/TradesList.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
TradesList <- TradesList %>%
# 1. Clean names
clean_names() %>%
# 2. Remove milliseconds and the last row
mutate(across(ends_with("date_time"), ~sub("\\..*", "", .))) %>%
slice(1:(n() - 1)) %>%
# 3. Separate entry date/time
separate(entry_date_time,
into = c("entry_date", "entry_time"),
sep = "\\s+",
remove = TRUE) %>%
# 4. Separate exit date/time
separate(exit_date_time,
into = c("exit_date", "exit_time"),
sep = "\\s+",
remove = TRUE) %>%
# 5. Convert dates to Date type
mutate(across(ends_with("_date"), as.Date, format = "%Y-%m-%d")) %>%
# 6. Convert times to hms
mutate(entry_time = as_hms(entry_time),
exit_time = as_hms(exit_time),
duration = as_hms(exit_time)) %>%
# 7. Clean symbol column
mutate(symbol = sub("\\s+.*", "", symbol)) %>%
# 8. Profit/Loss to numeric instead of character
mutate(profit_loss_c = parse_number(profit_loss_c)) %>%
# 9. Encrypt account number
mutate(account = str_sub(account, 1, -5) %>% paste0("****"))
View(TradesList)
analyze_trades = function(fromDate = "1900-01-01", toDate = Sys.Date())
{
# Convert inputs to Date type
start_date <- as.Date(fromDate)
end_date <- as.Date(toDate)
return(
TradesList %>%
filter(between(entry_date, start_date, end_date)) %>%
summarize(
# Average Win (Mean of P/L when > 5)
avgWin = mean(profit_loss_c[profit_loss_c > 5], na.rm = TRUE),
# Average Loss (Mean of P/L when < 0)
avgLoss = mean(profit_loss_c[profit_loss_c < 0], na.rm = TRUE),
# Win Multiple
winMultiple = abs(avgWin / avgLoss),
# Total trades considered for win/loss rate (P/L > 5 or P/L < 0)
totalTrades = sum(profit_loss_c > 5 | profit_loss_c < 0, na.rm = TRUE),
# Total Wins
totalWins = sum(profit_loss_c > 5, na.rm = TRUE),
# Total Losses
totalLosses = sum(profit_loss_c < 0, na.rm = TRUE),
# Win Rate (Count of wins / Total considered trades)
winRate = if_else(totalTrades > 0,
sum(profit_loss_c > 5, na.rm = TRUE) / totalTrades,
0),
# Loss Rate (Count of losses / Total considered trades)
loseRate = if_else(totalTrades > 0,
sum(profit_loss_c < 0, na.rm = TRUE) / totalTrades,
0)
)
)
}
}
analyze_trades()
library(tidyverse)
depth <- seq(0, 4000, length.out = 100)
site <- sample(c("A", "B", "C"), size = 100, replace = T)
temperature <- 25 - (depth / 200) +
rnorm(100, mean = 0, sd = 1) +
(site == "C")*5 +  (site == "C")*(depth/200)/2
ocean_data <- data.frame(Depth = depth, Temperature = temperature, Site = site)
ocean_data |>
ggplot(aes(x = Depth, y = Temperature, color = Site)) +
geom_point() +
geom_smooth(method = 'lm', se = 0 )
mod_temp_ps <- ...
View(seahawks_results)
## ----------------------------------------------------
## 1. GLOBAL SETUP & DATA WRANGLING
## ----------------------------------------------------
library(shiny)
library(shinydashboard)
## ----------------------------------------------------
## 1. GLOBAL SETUP & DATA WRANGLING
## ----------------------------------------------------
library(shiny)
library(ggplot2)
library(dplyr)
library(tidyr)
library(readr)
library(janitor)
library(hms)
library(stringr) # For str_sub
library(DT)      # For displaying tables
# --- Data Loading and Wrangling Pipeline ---
# NOTE: The file path must be accessible when the app runs.
# For deployment, this should ideally be in a relative path
# or use shinyFiles/fileInput.
TradesList_raw <- read_delim("C:/SierraChart/SavedTradeActivity/TradesList.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
TradesList_cleaned <- TradesList_raw %>%
# 1. Clean names
clean_names() %>%
# 2. Remove milliseconds and the last row
mutate(across(ends_with("date_time"), ~sub("\\..*", "", .))) %>%
slice(1:(n() - 1)) %>%
# 3. Separate date/time
separate(entry_date_time, into = c("entry_date", "entry_time"), sep = "\\s+", remove = TRUE) %>%
separate(exit_date_time, into = c("exit_date", "exit_time"), sep = "\\s+", remove = TRUE) %>%
# 4. Convert dates and times
mutate(across(ends_with("_date"), as.Date, format = "%Y-%m-%d"),
entry_time = as_hms(entry_time),
exit_time = as_hms(exit_time),
# Your duration calculation needs to be a proper time difference,
# not just a copy of exit_time. Assuming you want the difference in seconds/minutes:
duration = difftime(
as.POSIXct(paste(exit_date, exit_time)),
as.POSIXct(paste(entry_date, entry_time)),
units = "secs"
)
) %>%
# 5. Clean symbol column and encrypt account
mutate(symbol = sub("\\s+.*", "", symbol),
account = str_sub(account, 1, -5) %>% paste0("****")) %>%
# 6. Profit/Loss to numeric
mutate(profit_loss_c = parse_number(profit_loss_c))
## ----------------------------------------------------
## 2. UI (User Interface) Function
## ----------------------------------------------------
# Find the min/max dates for the date range selector
min_date <- min(TradesList_cleaned$entry_date, na.rm = TRUE)
max_date <- max(TradesList_cleaned$entry_date, na.rm = TRUE)
ui <- dashboardPage(
dashboardHeader(title = "ðŸ“ˆ Trading Journal Dashboard"),
dashboardSidebar(
# Date Range Filter
dateRangeInput("date_range_filter",
"Filter by Entry Date:",
start = min_date,
end = max_date,
min = min_date,
max = max_date),
# Symbol Filter
selectInput("symbol_filter",
"Select Symbol:",
choices = unique(TradesList_cleaned$symbol),
selected = unique(TradesList_cleaned$symbol),
multiple = TRUE)
),
dashboardBody(
# Main Metrics Row
fluidRow(
valueBoxOutput("total_trades_box", width = 3),
valueBoxOutput("total_pl_box", width = 3),
valueBoxOutput("win_rate_box", width = 3),
valueBoxOutput("win_multiple_box", width = 3) # Added Win Multiple
),
# Chart and Table Row
fluidRow(
box(title = "Cumulative P&L", status = "primary", solidHeader = TRUE, width = 6,
plotOutput("pl_chart")),
box(title = "Trades Detail", status = "info", solidHeader = TRUE, width = 6,
DTOutput("trades_table"))
)
)
)
getwd()
install.packages("shinydashboard")
## ----------------------------------------------------
## 1. GLOBAL SETUP & DATA WRANGLING
## ----------------------------------------------------
library(shiny)
library(shinydashboard)
library(ggplot2)
library(dplyr)
library(tidyr)
library(readr)
library(janitor)
library(hms)
library(stringr) # For str_sub
library(DT)      # For displaying tables
# --- Data Loading and Wrangling Pipeline ---
# NOTE: The file path must be accessible when the app runs.
# For deployment, this should ideally be in a relative path
# or use shinyFiles/fileInput.
TradesList_raw <- read_delim("C:/SierraChart/SavedTradeActivity/TradesList.txt",
delim = "\t", escape_double = FALSE,
trim_ws = TRUE)
TradesList_cleaned <- TradesList_raw %>%
# 1. Clean names
clean_names() %>%
# 2. Remove milliseconds and the last row
mutate(across(ends_with("date_time"), ~sub("\\..*", "", .))) %>%
slice(1:(n() - 1)) %>%
# 3. Separate date/time
separate(entry_date_time, into = c("entry_date", "entry_time"), sep = "\\s+", remove = TRUE) %>%
separate(exit_date_time, into = c("exit_date", "exit_time"), sep = "\\s+", remove = TRUE) %>%
# 4. Convert dates and times
mutate(across(ends_with("_date"), as.Date, format = "%Y-%m-%d"),
entry_time = as_hms(entry_time),
exit_time = as_hms(exit_time),
# Your duration calculation needs to be a proper time difference,
# not just a copy of exit_time. Assuming you want the difference in seconds/minutes:
duration = difftime(
as.POSIXct(paste(exit_date, exit_time)),
as.POSIXct(paste(entry_date, entry_time)),
units = "secs"
)
) %>%
# 5. Clean symbol column and encrypt account
mutate(symbol = sub("\\s+.*", "", symbol),
account = str_sub(account, 1, -5) %>% paste0("****")) %>%
# 6. Profit/Loss to numeric
mutate(profit_loss_c = parse_number(profit_loss_c))
## ----------------------------------------------------
## 2. UI (User Interface) Function
## ----------------------------------------------------
# Find the min/max dates for the date range selector
min_date <- min(TradesList_cleaned$entry_date, na.rm = TRUE)
max_date <- max(TradesList_cleaned$entry_date, na.rm = TRUE)
ui <- dashboardPage(
dashboardHeader(title = "ðŸ“ˆ Trading Journal Dashboard"),
dashboardSidebar(
# Date Range Filter
dateRangeInput("date_range_filter",
"Filter by Entry Date:",
start = min_date,
end = max_date,
min = min_date,
max = max_date),
# Symbol Filter
selectInput("symbol_filter",
"Select Symbol:",
choices = unique(TradesList_cleaned$symbol),
selected = unique(TradesList_cleaned$symbol),
multiple = TRUE)
),
dashboardBody(
# Main Metrics Row
fluidRow(
valueBoxOutput("total_trades_box", width = 3),
valueBoxOutput("total_pl_box", width = 3),
valueBoxOutput("win_rate_box", width = 3),
valueBoxOutput("win_multiple_box", width = 3) # Added Win Multiple
),
# Chart and Table Row
fluidRow(
box(title = "Cumulative P&L", status = "primary", solidHeader = TRUE, width = 6,
plotOutput("pl_chart")),
box(title = "Trades Detail", status = "info", solidHeader = TRUE, width = 6,
DTOutput("trades_table"))
)
)
)
## ----------------------------------------------------
## 3. SERVER Function
## ----------------------------------------------------
server <- function(input, output, session) {
# 1. Reactive Data Filtering
# This filters the pre-cleaned data based on UI inputs
filtered_data <- reactive({
req(input$date_range_filter)
req(input$symbol_filter)
TradesList_cleaned %>%
filter(
between(entry_date, input$date_range_filter[1], input$date_range_filter[2]),
symbol %in% input$symbol_filter
)
})
# 2. Reactive Summary Analysis (Your 'analyze_trades' logic)
summary_metrics <- reactive({
data <- filtered_data()
req(nrow(data) > 0) # Only proceed if data exists
# Your analyze_trades logic is now executed reactively
data %>%
summarize(
avgWin = mean(profit_loss_c[profit_loss_c > 5], na.rm = TRUE),
avgLoss = mean(profit_loss_c[profit_loss_c < 0], na.rm = TRUE),
winMultiple = abs(avgWin / avgLoss),
totalTrades = sum(profit_loss_c > 5 | profit_loss_c < 0, na.rm = TRUE),
totalWins = sum(profit_loss_c > 5, na.rm = TRUE),
totalLosses = sum(profit_loss_c < 0, na.rm = TRUE),
winRate = if_else(totalTrades > 0, totalWins / totalTrades, 0),
# Total P&L and Total Trades for the Value Boxes
total_pl = sum(profit_loss_c, na.rm = TRUE),
all_trades = nrow(data)
)
})
# --- Value Boxes Outputs ---
output$total_trades_box <- renderValueBox({
metrics <- summary_metrics()
valueBox(
value = metrics$all_trades,
subtitle = "Total Trades (Filtered)",
icon = icon("chart-line"),
color = "blue"
)
})
output$total_pl_box <- renderValueBox({
metrics <- summary_metrics()
valueBox(
value = paste0("$", format(round(metrics$total_pl, 2), big.mark = ",")),
subtitle = "Total P&L",
icon = icon("dollar-sign"),
color = ifelse(metrics$total_pl >= 0, "green", "red")
)
})
output$win_rate_box <- renderValueBox({
metrics <- summary_metrics()
valueBox(
value = paste0(round(metrics$winRate * 100, 1), "%"),
subtitle = "Win Rate (P/L > $5)",
icon = icon("trophy"),
color = "purple"
)
})
output$win_multiple_box <- renderValueBox({
metrics <- summary_metrics()
valueBox(
value = round(metrics$winMultiple, 2),
subtitle = "R-Multiple (Avg Win / Avg Loss)",
icon = icon("arrow-up-right-dots"),
color = "yellow"
)
})
# --- Chart Output ---
output$pl_chart <- renderPlot({
plot_data <- filtered_data() %>%
group_by(entry_date) %>%
summarise(DailyPL = sum(profit_loss_c, na.rm = TRUE)) %>%
ungroup() %>%
mutate(CumulativePL = cumsum(DailyPL))
req(nrow(plot_data) > 0)
ggplot(plot_data, aes(x = entry_date, y = CumulativePL)) +
geom_line(color = "steelblue", size = 1.2) +
geom_area(fill = "steelblue", alpha = 0.3) +
labs(title = "Cumulative Profit/Loss Over Time",
x = "Date",
y = "Cumulative P&L ($)") +
theme_minimal()
})
# --- Table Output ---
output$trades_table <- renderDT({
# Select columns to display in the table
display_cols <- filtered_data() %>%
select(symbol, entry_date, entry_time, exit_date, exit_time,
profit_loss_c, duration, account)
datatable(display_cols,
options = list(pageLength = 10, scrollX = TRUE),
rownames = FALSE) %>%
formatCurrency("profit_loss_c", currency = "$", digits = 2)
})
}
## ----------------------------------------------------
## 4. RUN THE APP
## ----------------------------------------------------
shinyApp(ui = ui, server = server)
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
getwd()
devtools::install_github("ropensci/plotly")
getwd()
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
install.packages("calendR")
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
View(Fid_Card_Transactions)
setwd()
getwd()
library(readr)
Fid_Card_Transactions <- read_csv("Fid_Card_Transactions.csv")
View(Fid_Card_Transactions)
library(tidyverse)
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = sum(Amount))
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = sum(abs(Amount))
Fid_Card_Transactions |>
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = sum(Amount))
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(Amount)))
Fid_Card_Transactions = Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(Amount)))
library(readr)
library(tidyverse)
Fid_Card_Transactions <- read_csv("Fid_Card_Transactions.csv")
View(Fid_Card_Transactions)
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(Amount)))
Fid_Card_Transactions = Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
mutate(cumulative = abs(cumsum(Amount)))
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(Amount)))
library(readr)
library(readr)
library(tidyverse)
Fid_Card_Transactions <- read_csv("Fid_Card_Transactions.csv")
View(Fid_Card_Transactions)
Fid_Card_Transactions |>
mutate(Amount = as.numeric(Amount))
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(Amount)))
library(readr)
library(tidyverse)
Fid_Card_Transactions <- read_csv("Fid_Card_Transactions.csv")
View(Fid_Card_Transactions)
Fid_Card_Transactions |>
mutate(Amount = as.numeric(Amount)) |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(Amount)))
Fid_Card_Transactions = Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE"),
collapse = "|"))) |>
mutate(cumulative = abs(cumsum(Amount)))
library(readr)
library(tidyverse)
Fid_Card_Transactions <- read_csv("Fid_Card_Transactions.csv")
View(Fid_Card_Transactions)
Fid_Card_Transactions |>
mutate(Amount = as.numeric(Amount)) |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE", "GREAT CLIPS"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(Amount)))
Fid_Card_Transactions = Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE", "GREAT CLIPS"),
collapse = "|"))) |>
mutate(cumulative = abs(cumsum(Amount)))
library(readr)
library(tidyverse)
Fid_Card_Transactions <- read_csv("Fid_Card_Transactions.csv")
View(Fid_Card_Transactions)
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE", "GREAT CLIPS"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(as.Numeric(Amount)))
Fid_Card_Transactions = Fid_Card_Transactions |>
library(readr)
library(tidyverse)
Fid_Card_Transactions <- read_csv("Fid_Card_Transactions.csv")
View(Fid_Card_Transactions)
Fid_Card_Transactions |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE", "GREAT CLIPS"),
collapse = "|"))) |>
summarize(totalSpentUWFood = abs(sum(as.Numeric(Amount))))
Fid_Card_Transactions = Fid_Card_Transactions |>
mutate(Amount = as.numeric(Amount)) |>
filter(str_detect(Name, paste(c("HFS", "SIZZLE&CRUNCH", "CHIPOTLE", "GREAT CLIPS"),
collapse = "|"))) |>
mutate(cumulative = abs(cumsum(Amount)))
shiny::runApp('SierraSync/Prototype')
runApp('SierraSync/Prototype')
shiny::runApp('SierraSync/Prototype')
